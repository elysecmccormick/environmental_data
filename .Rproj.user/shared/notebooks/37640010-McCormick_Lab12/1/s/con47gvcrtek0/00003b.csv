"0",""
"0",""
"0","alpha = 0.05"
"0","n_sims = 1000"
"0","int_obs = 0.0991"
"0","slope_obs = 0.00584"
"0","sd_obs = 0.1412668"
"0",""
"0","linear = function(x, y_int, slope)"
"0","{"
"0","      return(y_int + x * slope)"
"0","}"
"0",""
"0","linear_simulator = function(x, y_int, slope, st_dev)"
"0","{"
"0","  y <- linear(x, y_int, slope)"
"0","  n <- length(x)"
"0","  noise <- rnorm(n, mean = 0, sd = st_dev)"
"0","  "
"0","    return(y + noise)"
"0","}"
"0",""
"0","linear_sim_fit = function(x, slope, y_int, st_dev)"
"0","{"
"0","  y_sim = linear_simulator("
"0","    x = x,"
"0","    y_int = y_int,"
"0","    slope = slope,"
"0","    st_dev = st_dev"
"0","  )"
"0","  fit_sim = lm(y_sim ~ x)"
"0","  return(fit_sim)"
"0","}"
"0",""
"0","p_vals = numeric(n_sims)"
"0",""
"0","# specify the number of different standard deviation values to simulate:"
"0","n_sds = 20"
"0","pop_sds = seq(from = 0.01, to = 1.5, length.out = n_sds)"
"0",""
"0","pop_sd_powers = numeric(n_sds)"
"0",""
"0","for(j in 1:n_sds)"
"0","{"
"0","    for(i in 1:n_sims)"
"0","  {"
"0","    fit_sim = linear_sim_fit(x = birdhab$ls,"
"0","                             y_int = int_obs,"
"0","                             slope = slope_obs,"
"0","                             st_dev = pop_sds[j])"
"0","    p_vals[i] = summary(fit_sim)$coefficients[2, ""Pr(>|t|)""]"
"0","  }"
"0","  pop_sd_powers[j] = sum(p_vals < alpha) / n_sims"
"0","}"
"0",""
"0","sim_output_dispersion = data.frame("
"0","  sd = pop_sds,"
"0","  power = pop_sd_powers)"
"0",""
"0","fit_lowess_30 = loess(power ~ sd, data = sim_output_dispersion, span = 0.3)"
"0","newdata_disp = data.frame(sd = seq(0, 1.5, length.out = 100)) "
"0","plot("
"0","  x = newdata_disp$sd,"
"0","  y = predict(fit_lowess_30, newdata = newdata_disp),"
"0","  type = ""l"","
"0","  ylab = ""Statistical Power"", xlab = ""Dispersion"","
"0","  main = ""Dispersion vs. Power LOWESS/original"""
"0","  )"
